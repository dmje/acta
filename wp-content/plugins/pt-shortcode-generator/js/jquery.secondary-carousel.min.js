(function(b){b.fn.secondaryCarousel=function(d){var e={visible_items:5,type:"normal",auto:true,delay:3000};if(!d.type){if(b(this).hasClass("carousel-type-tabbed")){d.type="tabbed"}else{if(b(this).hasClass("carousel-type-normal")){d.type="normal"}}}settings=b.extend({},e,d);if(settings.type=="normal"){return this.each(function(){c(this,settings)})}else{if(settings.type=="tabbed"){$tabs=this.each(function(){a(this,settings)});$carousel=this.find("div.secondary-carousel-tab-contents").each(function(){c(this,settings)});return $carousel}}};function a(e,d){return this instanceof a?this.init(e,d):new a(e,d)}b.extend(a.prototype,{container:null,options:null,init:function(e,d){this.container=e;this.options=d;this.setupPositions();this.setupEvents()},setupPositions:function(){},setupEvents:function(){b("a.secondary-carousel-tab",this.container).bind("click",this,this.event_clickTab)},event_clickTab:function(d){var e=d.data;b("li.active",e.container).removeClass("active");b(this).parent().addClass("active");d.preventDefault()}});function c(e,d){return this instanceof c?this.init(e,d):new c(e,d)}b.extend(c.prototype,{container:null,options:null,image_width:0,image_outer_width:0,items_num:0,first_visible_item:0,visible_items:6,total_width:0,autoscroll_direction:"left",pause_autoscroll:false,loopingLeft:false,loopingRight:false,animating:false,init:function(e,d){this.container=e;this.options=d;b(this.container).addClass("carousel-type-"+this.options.type);this.items_num=b("li",this.container).size();this.image_width=b("li:first-child",this.container).innerWidth();this.image_outer_width=b("li:first-child",this.container).outerWidth();this.visible_items=d.visible_items;this.addWrapper();this.setWidth();if(this.items_num>this.visible_items){this.addControls()}this.setupEvents();if(this.options.auto){this.addAutoscroll()}},addWrapper:function(){b("ul",this.container).wrap('<div class="carousel-wrapper" />');b(this.container).css({overflow:"visible"})},setWidth:function(){this.total_width=this.image_outer_width*this.items_num;var d=this.image_width*this.visible_items;b("ul",this.container).width(this.total_width);b(".carousel-wrapper",this.container).width(d)},addControls:function(){if(this.items_num>this.visible_items){carousel_controls='<div class="carousel-nav">';carousel_controls+=' <a href="#" class="control left" title="Scroll left">&lt;</a>';carousel_controls+=' <a href="#" class="control right" title="Scroll right">&gt;</a>';carousel_controls+="</div>";b(carousel_controls).appendTo(this.container)}},addAutoscroll:function(){var d=this;setInterval(function(){d.event_autoscroll(d)},d.options.delay)},setupEvents:function(){var d=this;b("li",this.container).bind("mouseover",d,this.event_mouseoverItem);b("li",this.container).bind("mouseout",d,this.event_mouseoutItem);b(".carousel-nav",this.container).bind("mouseover",d,this.event_mouseoverItem);b(".carousel-nav",this.container).bind("mouseout",d,this.event_mouseoutItem);b(".carousel-nav .control.left",this.container).bind("click",d,this.event_clickControlLeft);b(".carousel-nav .control.right",this.container).bind("click",d,this.event_clickControlRight)},loopItemLeft:function(g){self=this;var f=self.items_num-1;var e=self.image_outer_width;if(!self.loopingLeft){self.loopingLeft=1}else{self.loopingLeft++}var d=self.total_width+(self.image_outer_width*self.visible_items);b("ul",self.container).width(d);b("ul",self.container).css({left:0-e});$cloned_item=b("ul",self.container).children().eq(f).clone();$cloned_item.prependTo(b("ul",self.container)).addClass("cloned");self.animating=true;b("ul",self.container).animate({left:"+="+e},function(){self.animating=false;if(self.loopingLeft==self.visible_items){e=(self.total_width-(self.image_outer_width*self.visible_items)-active_width);b("ul",self.container).css({left:0-e,position:"absolute"});b("ul",self.container).width(self.totalWidth);b("ul .cloned",self.container).remove();self.first_visible_item=self.items_num-self.visible_items;self.loopingLeft=false}})},rewindItemLeft:function(f){var d=this;if(d.loopingLeft){var e=d.image_outer_width;d.animating=true;b("ul",d.container).animate({left:"-="+e},function(){d.animating=false;var h=b("ul",d.container).children().first();var g=h.hasClass("cloned");if(g){h.remove();b("ul",d.container).css({left:0});d.first_visible_item=0;d.loopingLeft--;if(!b("ul",d.container).has(".cloned")){d.loopingLeft=false}}})}},loopItemRight:function(g){var e=this;var f=0-e.image_outer_width;e.loopingRight=true;var d=e.total_width+(e.image_outer_width*e.visible_items);b("ul",e.container).width(d);$cloned_item=b("ul",e.container).children().eq(g).clone();$cloned_item.appendTo(b("ul",e.container)).addClass("cloned");e.animating=true;b("ul",e.container).animate({left:"+="+f},function(){e.animating=false;if(g==(e.visible_items-1)){b("ul",e.container).css({left:0,position:"absolute"});b("ul",e.container).width(e.totalWidth);b("ul .cloned",e.container).remove();e.first_visible_item=0;e.loopingRight=false}});if(e.loopingRight){e.first_visible_item++}},rewindItemRight:function(f){var d=this;if(d.loopingRight){var e=0-d.image_outer_width;d.animating=true;b("ul",d.container).animate({left:"-="+e},function(){d.animating=false;var h=b("ul",d.container).children().last();var g=h.hasClass("cloned");if(g){h.remove();d.first_visible_item--;if((d.first_visible_item+d.visible_items)==d.items_num){d.loopingRight=false}}})}},do_moveLeft:function(){var e=this;if(!e.animating){var d=e.items_num-e.first_visible_item;if(e.first_visible_item==0||e.loopingLeft){e.loopItemLeft(d)}else{if(e.loopingRight){d=(e.first_visible_item+e.visible_items)-e.items_num;e.rewindItemRight(d)}else{e.animating=true;b("ul",e.container).animate({left:"+="+e.image_outer_width},function(){e.animating=false});e.first_visible_item--}}}},do_moveRight:function(){var f=this;if(!f.animating){var e=f.first_visible_item+f.visible_items;var d=e-f.items_num;if((e>=f.items_num)&&!f.loopingLeft){f.loopItemRight(d)}else{if(f.loopingLeft){f.rewindItemLeft(0)}else{f.animating=true;b("ul",f.container).animate({left:"-="+f.image_outer_width},function(){f.animating=false});f.first_visible_item++}}}},event_autoscroll:function(d){if(!d.pause_autoscroll){if(d.autoscroll_direction=="left"){d.do_moveRight()}else{d.do_moveLeft()}}},event_clickControlLeft:function(d){var e=d.data;e.do_moveLeft();d.preventDefault()},event_clickControlRight:function(d){var e=d.data;e.do_moveRight();d.preventDefault()},event_mouseoverItem:function(d){var e=d.data;e.pause_autoscroll=true},event_mouseoutItem:function(d){var e=d.data;e.pause_autoscroll=false},event_timeout_clickLeft:function(d,e){b(".carousel-nav .control.left",d.container).click();if(e>1){setTimeout(function(){d.event_timeout_clickLeft(d,e-1)},500)}},event_timeout_clickRight:function(d,e){b(".carousel-nav .control.right",d.container).click();if(e>1){setTimeout(function(){d.event_timeout_clickRight(d,e-1)},500)}}})})(jQuery);